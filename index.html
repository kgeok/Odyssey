
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Odyssey</title>
    <meta name = "viewport" content = "width=device-width, minimum-scale=1.0, maximum-scale = 1.0, user-scalable = no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="style.css" media="screen">
    <link rel="apple-touch-icon" sizes="180x180" href="https://github.com/kgeok/Odyssey/raw/main/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://github.com/kgeok/Odyssey/raw/main/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://github.com/kgeok/Odyssey/raw/main/icons/favicon-16x16.png">
    <link rel="manifest" href="https://github.com/kgeok/Odyssey/raw/main/icons/site.webmanifest">
    <link rel="mask-icon" href="https://github.com/kgeok/Odyssey/raw/main/icons/safari-pinned-tab.svg" color="#2b5797">
    <link rel="shortcut icon" href="https://github.com/kgeok/Odyssey/raw/main/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="msapplication-config" content="https://github.com/kgeok/Odyssey/raw/main/icons/browserconfig.xml">
    <body>
      <h2>Odyssey</h2>

      <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

        <script type="text/javascript">

        let release = "debug";
        let version = "0.1b";
        let map;
        let markers = [];
        var PinColor = "red";
        var state = [];
        var caption;
        var MarkerCounter = 0;
        var PinNum;

        function initMap() {
          map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: 41.850033, lng: -87.6500523 },
            streetViewControl: false,
            zoom: 4,
          });

          map.addListener("click", (e) => {

            placeMarker(map, e.latLng, caption);
            MarkerCounter++;
            document.cookie = "Pin" + MarkerCounter +"=" + e.latLng + "; expires=Fri, 31 Dec 9999 23:59:59 GMT; SameSite=None; Secure;";

          });

          var decodedCookie = decodeURIComponent(document.cookie);

          console.log(decodedCookie);

        }

        function removeMarker(){

          for (let i = 0; i < markers.length; i++) {
          markers[i].setMap(null);
          }
          markers = [];
          MarkerCounter = 0;
          state = "";
        }

        function removeLastMarker(){
        markers[Math.abs(MarkerCounter-1)].setMap(null);
        MarkerCounter--;
        if (MarkerCounter < 0){
          removeMarker();
        }
  
        }

        function placeMarker(map, coor, title){
         
         state[PinNum] = coor;
         
         PinNum++;
         var marker =  new google.maps.Marker({

          position: coor,
          map: map,
          animation: google.maps.Animation.Drop,
          title: title,
          clickable: true,
          draggable: true,
          label: title,
          icon: {
            url: "http://maps.google.com/mapfiles/ms/icons/"+ PinColor.toLocaleLowerCase() + "-dot.png"
          }

        });
        
        markers.push(marker);
        state = markers;

        

        caption = "";



        }

        function About(){

          prompt("Odyssey, Version " + version + ", With <3 by Kevin George.\n" + "Powered by Google Maps.\n", "http://kgeok.github.io")

        }

        function exportJSONFile(){

        var a = document.createElement("a");
       // a.href = URL.createObjectURL(new Blob([JSON.stringify(state, null, 2)], {
        a.href = URL.createObjectURL(new Blob([JSON.stringify(Object.entries(state))], {
        type: "application/json"
        }));

        a.setAttribute("download", "OdysseyJSON.json");
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        }

        function makeCaption(){
         caption = prompt("Caption");
        }
        </script>
        
<div id="map"></div>

<script
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD0KUvgW3e3ts3WkIob9RBzjGP6RvU7FeQ&callback=initMap&libraries=&v=weekly" async>
</script>
<br/>
<select id="color_picker" name="color_picker">
<option>Red</option>
<option>Orange</option>
<option>Yellow</option>
<option>Green</option>
<option>Blue</option>
<option>Purple</option>
</select>

<script>
document.getElementById("color_picker").onchange = function(){
PinColor = document.getElementById("color_picker").value;
}

</script>

<select id="moption_picker" name="moption_picker">
  <option selected>Marker Options</option>
  <option>Make Note Caption</option>
  <option>Delete Last Marker</option>
  <option>Clear All Markers</option>
  </select>

  <script>
  document.getElementById("moption_picker").onchange = function(){
  if (document.getElementById("moption_picker").value == "Marker Options"){
    
  }
  if (document.getElementById("moption_picker").value == "Make Note Caption"){
    makeCaption();
    document.getElementById("moption_picker").value = "Marker Options";
  }
  if (document.getElementById("moption_picker").value == "Delete Last Marker"){
    removeLastMarker();
    document.getElementById("moption_picker").value = "Marker Options";
  }
  if (document.getElementById("moption_picker").value == "Clear All Markers"){
    removeMarker();
    document.getElementById("moption_picker").value = "Marker Options";
  }
  }
  </script>

<button onclick="About()">About</button>
<br/>
